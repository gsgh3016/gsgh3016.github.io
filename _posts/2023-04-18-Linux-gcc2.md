---
layout: single
title: 리눅스 gcc(linux gcc) 2. Make
categories: Linux
---

# 1. `make` basic

## 1-1 create `make` file

```console
make -f makefile_name target.c
```

result: `makefile_name` making target.o created

## 1-2 `make` rule

```make
target: dependency(prerequisite)
    command
```

* target: result generated by make

* dependency: input to create target(not necessary)

* command: action to create target<br>**must be tab-indented**

<br>

***

# 2 `make` variable(macro)

set variables(macros) for easy variable edit

## 2-1 user defined

* act like `#define` in C

* string without any 'type', case-sensitive

* read with { } or ( )

```make
CC = gcc
CFLAGS = -Wall -std=c11

foo.o: foo.c foo.h
    $(CC) $(CFLAGS) -o foo.o -c foo.c
```

## 2-2 pattern symbols

<center>
    <table>
        <thead><tr><td>symbols</td><td>example</td><td>description</td></tr></thead>
        <tbody>
            <tr>
                <td>$@: target</td>
                <td>
                    <code class="language-makefile">
                        target: file1.c file2.c<br>
                        &emsp;&emsp;&emsp;&emsp;gcc -o $@ -c file1.c file2.c
                    </code>
                </td>
                <td>
                    same command as<br>
                    <code class="language-makefile">gcc -o target -c file1.c file2.c</code>
                </td>
            </tr>
            <tr>
                <td>%: any string</td>
                <td>
                    <code class="language-makefile">
                        %.o: %.c<br>
                        &emsp;&emsp;&emsp;&emsp;gcc -c $< -o $@
                    </code>
                </td>
                <td>compile *.c files and *.o respectively</td>
            </tr>
            <tr>
                <td>$<: first dependency</td>
                <td>
                    <code class="language-makefile">
                        target.o: file1.c file2.c<br>
                        &emsp;&emsp;&emsp;&emsp;gcc -c $< -o target.o
                    </code>
                </td>
                <td>
                    same command as<br>
                    <code class="language-makefile">gcc -c file1.c -o target</code>
                </td>
            </tr>
            <tr>
                <td>$^: all dependencies</td>
                <td>
                    <code class="language-makefile">
                        target: file1.c file2.c<br>
                        &emsp;&emsp;&emsp;&emsp;gcc -c $^
                    </code>
                </td>
                <td>
                    same command as<br>
                    <code class="language-makefile">gcc -c file1.c file2.c</code>
                </td>
            </tr>
            <tr>
                <td>$?: newer than target</td>
                <td>
                    <code class="language-makefile">
                        print:<br>
                        &emsp;&emsp;&emsp;&emsp;echo "It is new: $?"
                    </code>
                </td>
                <td>
                    print with new filename like:<br>
                    It is new: new_filename
                </td>
            </tr>
        </tbody>
    </table>
</center>

## 2-4 phony target

```make
all: target
```

default(final) target for makefile

```make
clean:
    command(usually rm)
```

delete unwanted temp files

<br>

***

# 3. compile with make

## 3-1 run total `makefile`

### single `makefile`,

```console
make
```

or

```console
make all_target
```

for phony target in `all:`

### multiple `makefile`

```console
make -f makefile_src
```

## 3-2 run specific target in  `makefile`

```console
make target_in_makefile
```